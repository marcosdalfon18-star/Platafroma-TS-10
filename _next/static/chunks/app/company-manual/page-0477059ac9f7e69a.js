(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4171],{66548:(e,a,s)=>{Promise.resolve().then(s.bind(s,68281))},68281:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>S});var l=s(95155),r=s(12115),t=s(10549),n=s(62523),i=s(30285),o=s(18046),c=s(75074),d=s(50172),u=s(31550),m=s(15300),x=s(18763),p=s(77223),g=s(66695),h=s(26126),v=s(17313),j=s(55964),f=s(40283),N=s(19053),C=s(7939),y=s(87481);let b={"vision-mision":"Misi\xf3n, Visi\xf3n y Valores",politicas:"Pol\xedticas Empresariales",normas:"Normas y Reglamentos",cultura:"Cultura Corporativa",procedimientos:"Procedimientos Operativos","codigo-conducta":"C\xf3digo de Conducta",valores:"Valores Corporativos","organigrama-funcional":"Organigrama Funcional"},w={"vision-mision":"bg-blue-100 text-blue-800",politicas:"bg-green-100 text-green-800",normas:"bg-yellow-100 text-yellow-800",cultura:"bg-purple-100 text-purple-800",procedimientos:"bg-orange-100 text-orange-800","codigo-conducta":"bg-red-100 text-red-800",valores:"bg-pink-100 text-pink-800","organigrama-funcional":"bg-gray-100 text-gray-800"};function E(){let[e,a]=(0,r.useState)(""),[s,N]=(0,r.useState)(!1),[E,S]=(0,r.useState)(null),[k,A]=(0,r.useState)("all"),{user:O}=(0,f.A)(),{toast:P}=(0,y.dj)(),D={canCreate:(null==O?void 0:O.role)==="consultor",canEdit:(null==O?void 0:O.role)==="consultor"||(null==O?void 0:O.role)==="empresario",canDelete:(null==O?void 0:O.role)==="consultor",canManageCategories:(null==O?void 0:O.role)==="consultor",canView:!0,isReadOnly:(null==O?void 0:O.role)==="empleado"||(null==O?void 0:O.role)==="gestor"},M=(null==O?void 0:O.companyId)||"default-company",{sections:V,loading:_,addSection:L,updateSection:$,removeSection:z}=(0,j.N)({companyId:M}),R=(0,r.useMemo)(()=>{let a=V;return"all"!==k&&(a=a.filter(e=>e.category===k)),e&&(a=a.filter(a=>a.title.toLowerCase().includes(e.toLowerCase())||a.content.toLowerCase().includes(e.toLowerCase()))),a},[V,e,k]),Z=(0,r.useMemo)(()=>{let e={};return R.forEach(a=>{e[a.category]||(e[a.category]=[]),e[a.category].push(a)}),Object.keys(e).forEach(a=>{e[a].sort((e,a)=>e.order-a.order)}),e},[R]),q=async e=>{if(!D.canCreate)return void P({title:"Permisos insuficientes",description:"Solo las Consultoras pueden crear nuevas secciones en el manual",variant:"destructive"});await L({companyId:M,category:e.category,title:e.title,content:e.content,order:e.order||0})},W=e=>{if(!D.canEdit)return void P({title:"Permisos insuficientes",description:"Solo Consultoras y Empresarios pueden editar el manual",variant:"destructive"});S(e),N(!0)},B=async e=>{if(E){if(!D.canEdit)return void P({title:"Permisos insuficientes",description:"Solo Consultoras y Empresarios pueden editar el manual",variant:"destructive"});await $(E.id,{category:e.category,title:e.title,content:e.content,order:e.order||0}),S(null)}},G=async e=>{if(!D.canDelete)return void P({title:"Permisos insuficientes",description:"Solo las Consultoras pueden eliminar secciones del manual",variant:"destructive"});confirm("\xbfEst\xe1s seguro de que quieres eliminar esta secci\xf3n?")&&await z(e)};return(0,l.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:(null==O?void 0:O.role)==="consultor"?"Manual de Empresa - Configuraci\xf3n":(null==O?void 0:O.role)==="empresario"?"Manual de Empresa":"Consultar Manual de Empresa"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:(null==O?void 0:O.role)==="consultor"?"Crea y gestiona el contenido del manual empresarial":(null==O?void 0:O.role)==="empresario"?"Encuentra informaci\xf3n sobre pol\xedticas, cultura y procedimientos":"Consulta informaci\xf3n sobre las pol\xedticas y cultura de la compa\xf1\xeda"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsx)(h.E,{variant:(null==O?void 0:O.role)==="consultor"?"default":"secondary",children:(null==O?void 0:O.role)==="consultor"?"\uD83D\uDC69‍\uD83D\uDCBC Consultora - Gesti\xf3n Completa":(null==O?void 0:O.role)==="empresario"?"\uD83C\uDFE2 Empresario - Edici\xf3n Permitida":(null==O?void 0:O.role)==="empleado"?"\uD83D\uDC68‍\uD83D\uDCBB Empleado - Solo Consulta":(null==O?void 0:O.role)==="gestor"?"\uD83D\uDC54 Gestor - Solo Consulta":"Usuario"}),D.isReadOnly&&(0,l.jsx)(h.E,{variant:"outline",className:"text-orange-600 border-orange-200",children:"\uD83D\uDC41️ Solo Lectura"})]})]}),D.canCreate&&(0,l.jsxs)(i.$,{onClick:()=>N(!0),children:[(0,l.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Nueva Secci\xf3n"]})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"relative flex-1",children:[(0,l.jsx)(c.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,l.jsx)(n.p,{placeholder:"Buscar en el manual...",className:"pl-10",value:e,onChange:e=>a(e.target.value)})]}),(0,l.jsx)(v.tU,{value:k,onValueChange:e=>A(e),children:(0,l.jsxs)(v.j7,{className:"grid grid-cols-4 lg:grid-cols-8",children:[(0,l.jsx)(v.Xi,{value:"all",children:"Todas"}),Object.entries(b).slice(0,7).map(e=>{let[a,s]=e;return(0,l.jsx)(v.Xi,{value:a,className:"hidden sm:flex",children:s.split(" ")[0]},a)})]})})]}),_?(0,l.jsx)("div",{className:"flex justify-center py-8",children:(0,l.jsx)(d.A,{className:"h-8 w-8 animate-spin"})}):0===V.length?(0,l.jsx)(g.Zp,{className:"mt-8",children:(0,l.jsxs)(g.Wu,{className:"p-8 text-center",children:[(0,l.jsx)(u.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Manual Vac\xedo"}),(0,l.jsx)("p",{className:"text-muted-foreground mb-4",children:D.canCreate?"Comienza agregando la primera secci\xf3n del manual de empresa.":D.canEdit?"El manual est\xe1 siendo preparado por la consultora. Podr\xe1s editarlo una vez que est\xe9 listo.":"El manual de empresa est\xe1 siendo preparado."}),D.canCreate&&(0,l.jsxs)(i.$,{onClick:()=>N(!0),children:[(0,l.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Agregar Primera Secci\xf3n"]})]})}):0===R.length?(0,l.jsx)(g.Zp,{className:"mt-8",children:(0,l.jsxs)(g.Wu,{className:"p-6 text-center",children:[(0,l.jsx)(m.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),(0,l.jsxs)("p",{className:"text-muted-foreground",children:['No se encontraron secciones para "',(0,l.jsx)("strong",{children:e}),'"',"all"!==k&&' en la categor\xeda "'.concat(b[k],'"'),"."]})]})}):(0,l.jsx)("div",{className:"grid gap-6",children:Object.entries(Z).map(e=>{let[a,s]=e;return(0,l.jsxs)(g.Zp,{children:[(0,l.jsx)(g.aR,{children:(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(g.ZB,{className:"text-xl",children:b[a]}),(0,l.jsxs)(h.E,{variant:"secondary",className:w[a],children:[s.length," ",1===s.length?"secci\xf3n":"secciones"]})]})})}),(0,l.jsx)(g.Wu,{children:(0,l.jsx)(t.nD,{type:"single",collapsible:!0,className:"w-full",children:s.map(e=>(0,l.jsxs)(t.As,{value:e.id,children:[(0,l.jsx)(t.$m,{className:"text-left",children:(0,l.jsxs)("div",{className:"flex items-center justify-between w-full mr-4",children:[(0,l.jsx)("span",{className:"font-semibold",children:e.title}),(D.canEdit||D.canDelete)&&(0,l.jsxs)("div",{className:"flex gap-1",onClick:e=>e.stopPropagation(),children:[D.canEdit&&(0,l.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>W(e),children:(0,l.jsx)(x.A,{className:"h-3 w-3"})}),D.canDelete&&(0,l.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>G(e.id),className:"text-destructive hover:text-destructive",children:(0,l.jsx)(p.A,{className:"h-3 w-3"})})]})]})}),(0,l.jsx)(t.ub,{className:"text-base leading-relaxed whitespace-pre-wrap",children:e.content})]},e.id))})})]},a)})}),(0,l.jsx)(C.A,{isOpen:s,onClose:()=>{N(!1),S(null)},onSave:E?B:q,editingSection:E,companyId:M})]})}function S(){return(0,l.jsx)(N.O,{children:(0,l.jsx)(E,{})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[2992,3644,4277,3909,4052,9233,2001,7788,2891,1844,8615,3510,8441,1684,7358],()=>a(66548)),_N_E=e.O()}]);