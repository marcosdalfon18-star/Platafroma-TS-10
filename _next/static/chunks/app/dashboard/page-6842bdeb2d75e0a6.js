(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105,5695],{10255:(e,t,r)=>{"use strict";function a(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return a}}),r(95155),r(47650),r(85744),r(20589)},17828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,r(64054).createAsyncLocalStorage)()},19053:(e,t,r)=>{"use strict";r.d(t,{O:()=>u});var a=r(95155),n=r(12115),s=r(35695),l=r(40283),i=r(50172);let u=e=>{let{children:t,allowedRoles:r}=e,{user:u,loading:o}=(0,l.A)(),d=(0,s.useRouter)();return((0,n.useEffect)(()=>{if(!o){if(!u)return void d.push("/");if(r&&!r.includes(u.role))return void d.push("/dashboard")}},[u,o,d,r]),o)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin"})}):u&&(!r||r.includes(u.role))?(0,a.jsx)(a.Fragment,{children:t}):null}},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},36645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let a=r(88229)._(r(67357));function n(e,t){var r;let n={};"function"==typeof e&&(n.loader=e);let s={...n,...t};return(0,a.default)({...s,modules:null==(r=s.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},40283:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>d});var a=r(95155),n=r(12115),s=r(93004),l=r(35317),i=r(70412);let u=(0,n.createContext)(void 0),o=()=>{let e=(0,n.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,s.hg)(i.j,async e=>{if(e){let t=await (0,l.x7)((0,l.H9)(i.db,"users",e.uid));if(t.exists()){let r=t.data();o({uid:e.uid,email:e.email,displayName:e.displayName||r.displayName,role:r.role,companyId:r.companyId})}}else o(null);c(!1)});return()=>e()},[]);let f=async(e,t)=>{c(!0);try{await (0,s.x9)(i.j,e,t)}catch(e){throw c(!1),e}},m=async(e,t,r,a)=>{c(!0);try{let{user:n}=await (0,s.eJ)(i.j,e,t);await (0,s.r7)(n,{displayName:r}),await (0,l.BN)((0,l.H9)(i.db,"users",n.uid),{email:e,displayName:r,role:a,createdAt:new Date,updatedAt:new Date})}catch(e){throw c(!1),e}},p=async()=>{await (0,s.CI)(i.j)},h=async e=>{await (0,s.J1)(i.j,e)},b=async e=>{if(!r||!i.j.currentUser)throw Error("No user authenticated");e.displayName&&e.displayName!==r.displayName&&await (0,s.r7)(i.j.currentUser,{displayName:e.displayName}),await (0,l.mZ)((0,l.H9)(i.db,"users",r.uid),{...e,updatedAt:(0,l.O5)()}),o(t=>t?{...t,...e}:null)},j=async()=>{if(!i.j.currentUser)throw Error("No user authenticated");await (0,s.gA)(i.j.currentUser)};return(0,a.jsx)(u.Provider,{value:{user:r,loading:d,login:f,register:m,logout:p,resetPassword:h,updateUserProfile:b,verifyEmail:j},children:t})}},44879:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(95155);r(12115);var n=r(55028),s=r(50172),l=r(19053),i=r(40283);let u=(0,n.default)(()=>Promise.all([r.e(4277),r.e(4052),r.e(9233),r.e(3103),r.e(7931),r.e(5279)]).then(r.bind(r,47931)),{loadableGenerated:{webpack:()=>[47931]},loading:()=>(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(s.A,{className:"h-8 w-8 animate-spin"})})}),o=(0,n.default)(()=>Promise.all([r.e(4277),r.e(4052),r.e(5474),r.e(9571),r.e(6797),r.e(3604)]).then(r.bind(r,66797)),{loadableGenerated:{webpack:()=>[66797]},loading:()=>(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(s.A,{className:"h-8 w-8 animate-spin"})})}),d=(0,n.default)(()=>Promise.all([r.e(4277),r.e(9233),r.e(5474),r.e(4800),r.e(3103),r.e(9643),r.e(6235),r.e(9588)]).then(r.bind(r,56235)),{loadableGenerated:{webpack:()=>[56235]},loading:()=>(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(s.A,{className:"h-8 w-8 animate-spin"})})}),c=(0,n.default)(()=>Promise.all([r.e(4277),r.e(5474),r.e(2247),r.e(3392)]).then(r.bind(r,73392)),{loadableGenerated:{webpack:()=>[73392]},loading:()=>(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(s.A,{className:"h-8 w-8 animate-spin"})})});function f(){return(0,a.jsx)(l.O,{children:(0,a.jsx)(m,{})})}function m(){let{user:e}=(0,i.A)(),t=new URLSearchParams(window.location.search).get("role"),r=t||(null==e?void 0:e.role)||"empresario";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4 p-2 bg-blue-50 border-l-4 border-blue-400 text-blue-700",children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Rol Actual:"})," ",r,t&&(0,a.jsx)("span",{className:"text-xs",children:" (modo testing)"})]}),(0,a.jsxs)("p",{className:"text-xs mt-1",children:["Para cambiar rol: ",(0,a.jsx)("code",{children:"?role=consultor"})," | ",(0,a.jsx)("code",{children:"?role=empresario"})," | ",(0,a.jsx)("code",{children:"?role=empleado"})," | ",(0,a.jsx)("code",{children:"?role=gestor"})]})]}),(()=>{switch(r){case"consultor":default:return(0,a.jsx)(u,{});case"empresario":return(0,a.jsx)(o,{});case"empleado":return(0,a.jsx)(d,{});case"gestor":return(0,a.jsx)(c,{})}})()]})}},48800:(e,t,r)=>{Promise.resolve().then(r.bind(r,44879))},50172:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},55028:(e,t,r)=>{"use strict";r.d(t,{default:()=>n.a});var a=r(36645),n=r.n(a)},62146:(e,t,r)=>{"use strict";function a(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),r(45262)},64054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{bindSnapshot:function(){return l},createAsyncLocalStorage:function(){return s},createSnapshot:function(){return i}});let r=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}static bind(e){return e}}let n="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function s(){return n?new n:new a}function l(e){return n?n.bind(e):a.bind(e)}function i(){return n?n.snapshot():function(e,...t){return e(...t)}}},67357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let a=r(95155),n=r(12115),s=r(62146);function l(e){return{default:e&&"default"in e?e.default:e}}r(10255);let i={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},u=function(e){let t={...i,...e},r=(0,n.lazy)(()=>t.loader().then(l)),u=t.loading;function o(e){let l=u?(0,a.jsx)(u,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,o=i?n.Suspense:n.Fragment,d=t.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(r,{...e})]}):(0,a.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(r,{...e})});return(0,a.jsx)(o,{...i?{fallback:l}:{},children:d})}return o.displayName="LoadableComponent",o}},70412:(e,t,r)=>{"use strict";r.d(t,{db:()=>o,j:()=>u,y:()=>i});var a=r(23915),n=r(93004),s=r(35317),l=r(87358);for(let e of["NEXT_PUBLIC_FIREBASE_API_KEY","NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN","NEXT_PUBLIC_FIREBASE_PROJECT_ID","NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET","NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","NEXT_PUBLIC_FIREBASE_APP_ID"])if(!l.env[e])throw Error("Missing required environment variable: ".concat(e));let i=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyCfyNXGXUX0ip0icCSuDlKasX2PN4GIKiY",authDomain:"studio-6568907544-ca1d2.firebaseapp.com",projectId:"studio-6568907544-ca1d2",storageBucket:"studio-6568907544-ca1d2.appspot.com",messagingSenderId:"95313933174",appId:"1:95313933174:web:04ac254b7c65fdbdbfc057"}),u=(0,n.xI)(i),o=(0,s.aU)(i)},85744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=r(17828)}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,3909,8441,1684,7358],()=>t(48800)),_N_E=e.O()}]);