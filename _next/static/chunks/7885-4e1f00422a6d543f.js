"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7885],{22346:(e,t,a)=>{a.d(t,{w:()=>i});var r=a(95155),s=a(12115),n=a(87489),l=a(59434);let i=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...c}=e;return(0,r.jsx)(n.b,{ref:t,decorative:i,orientation:s,className:(0,l.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...c})});i.displayName=n.b.displayName},26126:(e,t,a)=>{a.d(t,{E:()=>i});var r=a(95155);a(12115);var s=a(74466),n=a(59434);let l=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:a}),t),...s})}},30285:(e,t,a)=>{a.d(t,{$:()=>d,r:()=>c});var r=a(95155),s=a(12115),n=a(66634),l=a(74466),i=a(59434);let c=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:d=!1,...o}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(c({variant:s,size:l,className:a})),ref:t,...o})});d.displayName="Button"},40283:(e,t,a)=>{a.d(t,{A:()=>d,AuthProvider:()=>o});var r=a(95155),s=a(12115),n=a(93004),l=a(35317),i=a(70412);let c=(0,s.createContext)(void 0),d=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},o=e=>{let{children:t}=e,[a,d]=(0,s.useState)(null),[o,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,n.hg)(i.j,async e=>{if(e){let t=await (0,l.x7)((0,l.H9)(i.db,"users",e.uid));if(t.exists()){let a=t.data();d({uid:e.uid,email:e.email,displayName:e.displayName||a.displayName,role:a.role,companyId:a.companyId})}}else d(null);u(!1)});return()=>e()},[]);let m=async(e,t)=>{u(!0);try{await (0,n.x9)(i.j,e,t)}catch(e){throw u(!1),e}},f=async(e,t,a,r)=>{u(!0);try{let{user:s}=await (0,n.eJ)(i.j,e,t);await (0,n.r7)(s,{displayName:a}),await (0,l.BN)((0,l.H9)(i.db,"users",s.uid),{email:e,displayName:a,role:r,createdAt:new Date,updatedAt:new Date})}catch(e){throw u(!1),e}},x=async()=>{await (0,n.CI)(i.j)},h=async e=>{await (0,n.J1)(i.j,e)},g=async e=>{if(!a||!i.j.currentUser)throw Error("No user authenticated");e.displayName&&e.displayName!==a.displayName&&await (0,n.r7)(i.j.currentUser,{displayName:e.displayName}),await (0,l.mZ)((0,l.H9)(i.db,"users",a.uid),{...e,updatedAt:(0,l.O5)()}),d(t=>t?{...t,...e}:null)},p=async()=>{if(!i.j.currentUser)throw Error("No user authenticated");await (0,n.gA)(i.j.currentUser)};return(0,r.jsx)(c.Provider,{value:{user:a,loading:o,login:m,register:f,logout:x,resetPassword:h,updateUserProfile:g,verifyEmail:p},children:t})}},59434:(e,t,a)=>{a.d(t,{cn:()=>n});var r=a(52596),s=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},66695:(e,t,a)=>{a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>l,aR:()=>i,wL:()=>u});var r=a(95155),s=a(12115),n=a(59434);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});c.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});o.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},70412:(e,t,a)=>{a.d(t,{db:()=>d,j:()=>c,y:()=>i});var r=a(23915),s=a(93004),n=a(35317),l=a(87358);for(let e of["NEXT_PUBLIC_FIREBASE_API_KEY","NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN","NEXT_PUBLIC_FIREBASE_PROJECT_ID","NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET","NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","NEXT_PUBLIC_FIREBASE_APP_ID"])if(!l.env[e])throw Error("Missing required environment variable: ".concat(e));let i=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyCfyNXGXUX0ip0icCSuDlKasX2PN4GIKiY",authDomain:"studio-6568907544-ca1d2.firebaseapp.com",projectId:"studio-6568907544-ca1d2",storageBucket:"studio-6568907544-ca1d2.appspot.com",messagingSenderId:"95313933174",appId:"1:95313933174:web:04ac254b7c65fdbdbfc057"}),c=(0,s.xI)(i),d=(0,n.aU)(i)},75171:(e,t,a)=>{a.d(t,{a:()=>b});var r=a(95155),s=a(12115),n=a(66695),l=a(30285),i=a(26126),c=a(22346),d=a(37648),o=a(91721),u=a(17104),m=a(33349),f=a(86578),x=a(13300),h=a(59099),g=a(53764),p=a(59434),v=a(35317);let b=e=>{let{todayAttendance:t,onCheckIn:a,onCheckOut:b,onStartBreak:N,onEndBreak:j,loading:y,employeeName:w="Usuario"}=e,[k,E]=(0,s.useState)(new Date);(0,s.useEffect)(()=>{let e=setInterval(()=>{E(new Date)},1e3);return()=>clearInterval(e)},[]);let I=e=>(e instanceof v.Dc?e.toDate():e).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),S=(null==t?void 0:t.breakStart)&&!(null==t?void 0:t.breakEnd);return(0,r.jsxs)(n.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(n.aR,{className:"text-center",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,r.jsx)(d.A,{className:"h-6 w-6"}),(0,r.jsx)(n.ZB,{children:"Control Horario"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-muted-foreground",children:(e=>(e instanceof v.Dc?e.toDate():e).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))(k)}),(0,r.jsx)("div",{className:"text-4xl font-mono font-bold",children:I(k)})]})]}),(0,r.jsxs)(n.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"font-medium",children:w})]}),(0,r.jsx)(i.E,{className:(0,p.cn)((()=>{if(!t)return"bg-gray-500";switch(t.status){case"present":return"bg-green-500";case"late":return"bg-yellow-500";case"absent":return"bg-red-500";case"half_day":return"bg-blue-500";default:return"bg-gray-500"}})(),"text-white"),children:(()=>{if(!t)return"Sin registros";switch(t.status){case"present":return"Presente";case"late":return"Tarde";case"absent":return"Ausente";case"half_day":return"Medio d\xeda";case"holiday":return"D\xeda festivo";default:return"Sin estado"}})()})]}),(0,r.jsx)(c.w,{}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Entrada"}),(0,r.jsx)("p",{className:"font-mono font-semibold",children:(null==t?void 0:t.checkIn)?I(t.checkIn):"--:--:--"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Salida"}),(0,r.jsx)("p",{className:"font-mono font-semibold",children:(null==t?void 0:t.checkOut)?I(t.checkOut):"--:--:--"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Descanso"}),(0,r.jsx)("p",{className:"font-mono font-semibold",children:(null==t?void 0:t.breakStart)&&(null==t?void 0:t.breakEnd)?"".concat(I(t.breakStart)," - ").concat(I(t.breakEnd)):S?"".concat(I(t.breakStart)," - Activo"):"--:-- - --:--"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tiempo trabajado"}),(0,r.jsx)("p",{className:"font-mono font-semibold text-green-600",children:(()=>{if(!(null==t?void 0:t.checkIn))return"00:00:00";let e=t.checkIn instanceof v.Dc?t.checkIn.toDate():t.checkIn,a=((null==t?void 0:t.checkOut)?t.checkOut instanceof v.Dc?t.checkOut.toDate():t.checkOut:k).getTime()-e.getTime();if(t.breakStart&&t.breakEnd){let e=t.breakStart instanceof v.Dc?t.breakStart.toDate():t.breakStart;a-=(t.breakEnd instanceof v.Dc?t.breakEnd.toDate():t.breakEnd).getTime()-e.getTime()}let r=Math.floor(a/1e3),s=Math.floor(r/3600),n=Math.floor(r%3600/60);return"".concat(s.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat((r%60).toString().padStart(2,"0"))})()})]})]}),(0,r.jsx)(c.w,{}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,r.jsxs)(l.$,{onClick:a,disabled:y||(null==t?void 0:t.checkIn)&&!(null==t?void 0:t.checkOut),variant:(null==t?void 0:t.checkIn)?"outline":"default",size:"lg",className:"flex flex-col gap-1 h-auto py-3",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Entrada"})]}),(0,r.jsxs)(l.$,{onClick:b,disabled:y||!(null==t?void 0:t.checkIn)||(null==t?void 0:t.checkOut),variant:(null==t?void 0:t.checkOut)?"outline":"default",size:"lg",className:"flex flex-col gap-1 h-auto py-3",children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Salida"})]}),(0,r.jsxs)(l.$,{onClick:N,disabled:y||!(null==t?void 0:t.checkIn)||(null==t?void 0:t.checkOut)||S,variant:S?"outline":"secondary",size:"lg",className:"flex flex-col gap-1 h-auto py-3",children:[(0,r.jsx)(f.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Iniciar Descanso"})]}),(0,r.jsxs)(l.$,{onClick:j,disabled:y||!S,variant:(null==t?void 0:t.breakEnd)?"outline":"secondary",size:"lg",className:"flex flex-col gap-1 h-auto py-3",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"text-xs",children:"Fin Descanso"})]})]}),t&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Resumen del d\xeda"})]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[t.totalHours&&(0,r.jsxs)("p",{children:["Horas totales: ",t.totalHours.toFixed(2)," horas"]}),t.notes&&(0,r.jsxs)("p",{children:["Notas: ",t.notes]})]})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("div",{className:(0,p.cn)("flex items-center gap-2 px-3 py-1 rounded-full text-sm",S?"bg-yellow-100 text-yellow-800":(null==t?void 0:t.checkIn)&&!(null==t?void 0:t.checkOut)?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:[S&&(0,r.jsx)(g.A,{className:"h-3 w-3"}),(null==t?void 0:t.checkIn)&&!(null==t?void 0:t.checkOut)&&!S&&(0,r.jsx)(x.A,{className:"h-3 w-3"}),(0,r.jsx)("span",{children:S?"En descanso":(null==t?void 0:t.checkIn)&&!(null==t?void 0:t.checkOut)?"Trabajando":"Fuera del horario laboral"})]})})]})]})}}}]);